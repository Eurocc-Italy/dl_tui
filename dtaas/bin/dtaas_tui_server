#!/usr/bin/env python
"""
Module to interface with HPC (G100) from the VM. The purpose of this module is to take the user query and script,
send a HPC job on G100 which calls the wrapper.py on the compute nodes and runs the script on the query results.

Author: @lbabetto
"""

from dtaas.tuilib.common import Config, UserInput
from dtaas.tuilib.server import launch_job

import logging

# setting up logger
logger = logging.getLogger(__name__)
handler = logging.StreamHandler()
formatter = logging.Formatter("%(asctime)s %(name)-12s %(levelname)-8s %(message)s")
handler.setFormatter(formatter)
logger.addHandler(handler)
logger.setLevel(logging.DEBUG)

# loading config
config = Config(version="server")

# running query and script
user_input = UserInput.from_cli()

# Launching job
launch_job(
    config=config,
    user_input=user_input,
)
